<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Karen Blocksom" />

<meta name="date" content="2018-08-03" />

<title>Calculating Relative Bed Stability</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Calculating Relative Bed Stability</h1>
<h4 class="author"><em>Karen Blocksom</em></h4>
<h4 class="date"><em>2018-08-03</em></h4>



<div id="preliminaries" class="section level1">
<h1>1 Preliminaries</h1>
<p>Bed stability is important to measuring physical habitat condition in streams for the National Rivers and Streams Assessment. The function <code>nrsaBedStability()</code> uses metrics calculated from other functions in this package, some of which have different names for boatable and wadeable versions, to calculate a number of metrics related to bed stability. The purpose of this vignette is to provide an example of the calculation of bed stability metrics using the outputs of other physical habitat functions.</p>
<hr />
</div>
<div id="calculating-inputs-for-bed-stability-function" class="section level1">
<h1>2 Calculating Inputs for Bed Stability Function</h1>
<p>First calculate all of the input metrics required as inputs. The following functions calculate the necessary input metrics: <code>nrsaChannelMorphology()</code>, <code>nrsaFishCover()</code>, <code>nrsaLargeWoody()</code>, <code>nrsaResidualPools()</code>, <code>nrsaSlopeBearing()</code>, <code>nrsaSubstrateCharacterization()</code>. In turn, some of those functions use data from other functions. For example, the function <code>nrsaGeneral()</code> feeds reach length into <code>nrsaLargeWoody()</code>. Some care is required because a great deal of data manipulation may be required to provide the correct function inputs. In some cases, function inputs (arguments) appear to call for the same information, but subtle differences may exist in what is expected. For more information on the details of what is expected as input for each function, see the help page for that function. In general, function inputs are data frames, with SITE as the name of the site-visit identifier, VALUE as the name of the result for the parameter of interest, and TRANSECT as the name of the transect where data were collected. UNITS may be required for certain inputs as well.</p>
<div id="channel-morphology-metrics" class="section level2">
<h2>2.1 Channel morphology metrics</h2>
<p>Several channel morphology metrics are required as inputs for <code>nrsaBedStability()</code>. These include mean and standard deviation for depth, for wadeable and boatable sites separately, mean bankfull height and width, and mean wetted width. To run the <code>nrsaChannelMorphology()</code> function, all data inputs are required. Boatable inputs for bankfull height and width, wetted width, and incised height are recorded in the channel/riparian transect data, and depth measurements come from thalweg data. Wadeable inputs for bankfull height and width and incised height come from channel/riparian cross-section data, and depth and wetted width come from thalweg profile data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(aquamet)</code></pre></div>
<pre><code>## 
## Attaching package: 'aquamet'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     lag</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     trimws</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stringr)</code></pre></div>
<pre><code>## Warning: package 'stringr' was built under R version 3.4.4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(plyr)</code></pre></div>
<pre><code>## Warning: package 'plyr' was built under R version 3.4.4</code></pre>
<pre><code>## 
## Attaching package: 'plyr'</code></pre>
<pre><code>## The following objects are masked from 'package:aquamet':
## 
##     count, rename</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(bankgeomEx)</code></pre></div>
<pre><code>##       SITE TRANSECT BANK SAMPLE_TYPE PARAMETER VALUE UNITS FLAG
## 5587 10002        I   LF  PHAB_CHANW  UNDERCUT   0.6     M     
## 5588 10002        I NONE  PHAB_CHANW   BANKHGT   1.9     M     
## 5589 10002        I NONE  PHAB_CHANW   BANKWID   7.1     M     
## 5590 10002        I NONE  PHAB_CHANW    BARWID     0     M     
## 5591 10002        I NONE  PHAB_CHANW  INCISHGT   2.6     M     
## 5592 10002        I NONE  PHAB_CHANW    WETWID   0.9     M</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(thalwegEx)</code></pre></div>
<pre><code>##        SITE TRANSECT STATION SAMPLE_TYPE PARAMETER VALUE FLAG UNITS
## 48716 10000        A       0  PHAB_THALW BACKWATER     N       NONE
## 48717 10000        A       0  PHAB_THALW  BAR_PRES     N       NONE
## 48718 10000        A       0  PHAB_THALW  CHANUNCD    GL       NONE
## 48719 10000        A       0  PHAB_THALW     DEPTH    18         CM
## 48720 10000        A       0  PHAB_THALW  INCREMNT   1.1          M
## 48721 10000        A       0  PHAB_THALW  POOLFMCD     N       NONE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bBH &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'BANKHT'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANBFRONT'</span>)
bBW &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'BANKWID'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANBFRONT'</span>)
bD &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx,(PARAMETER<span class="op">==</span><span class="st">'DEP_SONR'</span><span class="op">|</span>PARAMETER<span class="op">==</span><span class="st">'DEP_POLE'</span>) <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THAL'</span>)
bWW &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'WETWID'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANBFRONT'</span>)
bInc &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'INCISED'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANBFRONT'</span>)
wBH &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'BANKHGT'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANW'</span>)
wBW &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'BANKWID'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANW'</span>)
wD &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx,PARAMETER<span class="op">==</span><span class="st">'DEPTH'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>)
wWW &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx,PARAMETER<span class="op">==</span><span class="st">'WETWIDTH'</span>)
wInc &lt;-<span class="st"> </span><span class="kw">subset</span>(bankgeomEx,PARAMETER<span class="op">==</span><span class="st">'INCISHGT'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANW'</span>)

chanmorphOut &lt;-<span class="st"> </span><span class="kw">nrsaChannelMorphology</span>(<span class="dt">bBankHeight=</span>bBH, <span class="dt">bBankWidth=</span>bBW,
    <span class="dt">bDepth=</span>bD, <span class="dt">bIncisedHeight=</span>bInc, <span class="dt">bWettedWidth=</span>bWW, <span class="dt">wBankHeight=</span>wBH,
    <span class="dt">wBankWidth=</span>wBW, <span class="dt">wDepth=</span>wD, <span class="dt">wIncisedHeight=</span>wInc, <span class="dt">wWettedWidth=</span>wWW)</code></pre></div>
<pre><code>##   metsChannelMorphology started.1.2.3.4  Complete summaryby summaries..5.6.7.8.10.11 Complete ratios..12.cm.13  Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(chanmorphOut)</code></pre></div>
<pre><code>##    SITE  METRIC      VALUE
## 1 10000  xwidth  2.2525000
## 2 10002  xwidth  3.2900000
## 3 10000 sdwidth  0.8437814
## 4 10002 sdwidth  1.6571694
## 5 10000     n_w 20.0000000
## 6 10002     n_w 20.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(chanmorphOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##  [1] &quot;xwidth&quot;     &quot;sdwidth&quot;    &quot;n_w&quot;        &quot;xbkf_w&quot;     &quot;sdbkf_w&quot;   
##  [6] &quot;n_bw&quot;       &quot;xbkf_h&quot;     &quot;sdbkf_h&quot;    &quot;n_bh&quot;       &quot;xinc_h&quot;    
## [11] &quot;sdinc_h&quot;    &quot;n_incis&quot;    &quot;bfwd_rat&quot;   &quot;xwxd&quot;       &quot;xwd_rat&quot;   
## [16] &quot;sdwxd&quot;      &quot;sdwd_rat&quot;   &quot;n_bfrat&quot;    &quot;n_wd&quot;       &quot;n_wdr&quot;     
## [21] &quot;xdepth&quot;     &quot;sddepth&quot;    &quot;n_d&quot;        &quot;xdepth_cm&quot;  &quot;sddepth_cm&quot;</code></pre>
</div>
<div id="fish-cover-metrics" class="section level2">
<h2>2.2 Fish cover metrics</h2>
<p>The metric for mean fish cover provided by large woody debris is a required input for <code>nrsaBedStability()</code>. The inputs for the function <code>nrsaFishCover()</code> include measurements of several fish cover parameters representing filamentous algae, boulders, brush and small woody debris, live trees or roots, macrophytes, overhanging vegetation, artificial structures, undercut banks, and large woody debris. Each measurement is in its own data frame and includes at a minimum <code>SITE</code> and <code>VALUE</code> as variables. In the example below, the data frames are each created within the call to the function by subset a larger data frame containing all of the fish cover data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(fishcoverEx)</code></pre></div>
<pre><code>##       SITE TRANSECT SAMPLE_TYPE PARAMETER VALUE FLAG
## 6137 10000        A  PHAB_CHANW     ALGAE     0     
## 6138 10000        A  PHAB_CHANW    BOULDR     0     
## 6139 10000        A  PHAB_CHANW     BRUSH     0     
## 6140 10000        A  PHAB_CHANW    LVTREE     1     
## 6141 10000        A  PHAB_CHANW    MACPHY     0     
## 6142 10000        A  PHAB_CHANW    OVRHNG     0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fishCvrOut &lt;-<span class="st"> </span><span class="kw">nrsaFishCover</span>(<span class="dt">algae=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'ALGAE'</span>),
  <span class="dt">boulder=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'BOULDR'</span>),
  <span class="dt">brush=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'BRUSH'</span>),
  <span class="dt">liveTree=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'LVTREE'</span>),
  <span class="dt">macrophytes=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'MACPHY'</span>),
  <span class="dt">overhang=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'OVRHNG'</span>),
  <span class="dt">structures=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'STRUCT'</span>),
  <span class="dt">undercut=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'UNDCUT'</span>),
  <span class="dt">woodyDebris=</span><span class="kw">subset</span>(fishcoverEx,PARAMETER<span class="op">==</span><span class="st">'WOODY'</span>))</code></pre></div>
<pre><code>##   Fish Cover mets.1.2.3.4.5.6.7 Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(fishCvrOut)</code></pre></div>
<pre><code>##    SITE  METRIC     VALUE
## 1 10000 pfc_alg 0.0000000
## 2 10002 pfc_alg 0.0000000
## 3 13799 pfc_alg 0.0000000
## 4 13904 pfc_alg 0.0000000
## 5 10000 pfc_rck 0.3636364
## 6 10002 pfc_rck 0.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(fishCvrOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##  [1] &quot;pfc_alg&quot;  &quot;pfc_rck&quot;  &quot;pfc_brs&quot;  &quot;pfc_lvt&quot;  &quot;pfc_aqm&quot;  &quot;pfc_ohv&quot; 
##  [7] &quot;pfc_hum&quot;  &quot;pfc_ucb&quot;  &quot;pfc_lwd&quot;  &quot;xfc_alg&quot;  &quot;xfc_rck&quot;  &quot;xfc_brs&quot; 
## [13] &quot;xfc_lvt&quot;  &quot;xfc_aqm&quot;  &quot;xfc_ohv&quot;  &quot;xfc_hum&quot;  &quot;xfc_ucb&quot;  &quot;xfc_lwd&quot; 
## [19] &quot;pfc_nat&quot;  &quot;pfc_big&quot;  &quot;pfc_all&quot;  &quot;xfc_nat&quot;  &quot;xfc_big&quot;  &quot;xfc_all&quot; 
## [25] &quot;sdfc_ohv&quot; &quot;sdfc_ucb&quot; &quot;idrohv&quot;   &quot;idrucb&quot;   &quot;iqrohv&quot;   &quot;iqrucb&quot;</code></pre>
</div>
<div id="large-woody-debris-metrics" class="section level2">
<h2>2.3 Large woody debris metrics</h2>
<p>The mean bankfull woody debris is a required input for calculating bed stability metrics. One of the inputs to the function <code>nrsaLargeWoody()</code> is mean bankfull width, which is the metric <code>xbkf_w</code> from the data frame <code>chanmorphOut</code>, which was generated above in (2.1). Other inputs to the function need to be constructed.</p>
<div id="obtain-reach-length-inputs" class="section level3">
<h3>2.3.1 Obtain reach length inputs</h3>
<p>To obtain the inputs for the function calculating large woody debris metrics, we must first calculate reach length for each site. We use <code>nrsaGeneral()</code> to perform this calculation, so the appropriate inputs for this function must be created first from thalweg profile data. The first argument, <code>sampledTransects</code>, is a data frame with all of the unique SITE and TRANSECT combinations in the data. The argument <code>sideChannels</code> is data frame containing SITE, TRANSECT, and VALUE, with values indicating whether a station is in a side channel (Y/N). For NRSA, this is the parameter <code>SIDCHN</code> in wadeable sites and <code>OFF_CHAN</code> in boatable sites.</p>
<p>The third argument is for a data frame containing the variables SITE, TRANSECT, and VALUE, with value as the spacing between each transect. In boatable sites in NRSA, this is obtained from the actual transect spacing parameter (<code>ACTRANSP</code>) on the channel/riparian transect form for each transect. For wadeable sites, the increment parameter (<code>INCREMNT</code>), which is only filled in on for the A-B transect, is used to determine transect spacing. The increment represents the spacing between stations along the thalweg between the A and B transects. Thus, we must calculate the number of stations sampled per transect and sum the increment to obtain the total length measured. Thalweg data is recorded between transects, and the last measurement is recorded one increment short of transect K. For this reason, the reach length by transect for wadeable sites will typically be (number of stations)x(increment) for A-I and (number of stations - 1)x(increment) for transect J. We need to combine the boatable and wadeable transect spacing into a single data frame.</p>
<p>The final argument is a character vector containing the values of transects that are used to specify a side channel. The default value for this argument reflects the NRSA values (XA, XB, XC, etc.). Because we are using standardize EPA NRSA data, we do not need to specify this argument. The function will just use the default.</p>
<p>In this vignette, the output data frame contains all of the metrics calculated by this function. To use as an argument in the <code>nrsaLargeWoody()</code> function, we will need to subset the data frame <code>genOut</code> for just the <code>reachlen</code> variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run nrsaGeneral() to obtain reach length metric</span>
wTr &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx, PARAMETER<span class="op">==</span><span class="st">'INCREMNT'</span> <span class="op">&amp;</span><span class="st"> </span>TRANSECT<span class="op">==</span><span class="st">'A'</span> <span class="op">&amp;</span><span class="st"> </span>STATION<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>
                 ,<span class="dt">select=</span><span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'VALUE'</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">merge</span>(plyr<span class="op">::</span><span class="kw">ddply</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(thalwegEx, SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>, <span class="dt">select=</span><span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>,<span class="st">'STATION'</span>))),
                    <span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>), summarise, <span class="dt">nSta =</span> <span class="kw">length</span>(STATION)), <span class="dt">by =</span> <span class="st">'SITE'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">ddply</span>(<span class="kw">c</span>(<span class="st">'SITE'</span>), mutate, <span class="dt">lastTran=</span><span class="kw">max</span>(TRANSECT)) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(wTr, <span class="dt">VALUE =</span> <span class="kw">ifelse</span>(TRANSECT<span class="op">!=</span>lastTran, nSta<span class="op">*</span>VALUE, (nSta<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>VALUE)) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>nSta,<span class="op">-</span>lastTran)


bTr &lt;-<span class="st"> </span><span class="kw">subset</span>(changeomEx,PARAMETER<span class="op">==</span><span class="st">'ACTRANSP'</span>,<span class="dt">select=</span><span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>,<span class="st">'VALUE'</span>))
tranSpace &lt;-<span class="st"> </span><span class="kw">rbind</span>(wTr,bTr) <span class="op">%&gt;%</span><span class="st"> </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))

genOut &lt;-<span class="st"> </span><span class="kw">nrsaGeneral</span>(<span class="dt">sampledTransects=</span><span class="kw">unique</span>(thalwegEx[,<span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>)]),
                        <span class="dt">sideChannels=</span><span class="kw">subset</span>(thalwegEx,PARAMETER <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">'SIDCHN'</span>,<span class="st">'OFF_CHAN'</span>)),
                        <span class="dt">transectSpacing=</span>tranSpace)</code></pre></div>
<pre><code>##   General mets .1.2.3.Done</code></pre>
</div>
<div id="create-additional-inputs-and-call-function" class="section level3">
<h3>2.3.2 Create additional inputs and call function</h3>
<p>There are separate arguments for large woody debris counts from boatable and wadeable sites. At wadeable sites, large woody debris counts are recorded on the NRSA thalweg profile and woody debris form, and at boatable sites, these counts are recorded on the channel/riparian transect form. The expected input data frames have the variables SITE, CLASS, and VALUE. The woody debris example dataset originally contained SITE, PARAMETER, and VALUE, so PARAMETER has to be renamed to CLASS. The expected CLASS values are as used in NRSA: DLDLL, DLDML, DLDSL, DMDLL, DMDML, DMDSL, DSDLL, DSDML, DSDSL, DXDLL, DXDML, DXDSL, WLDLL, WLDML, WLDSL, WMDLL, WMDML, WMDSL, WSDLL, WSDML, WSDSL, WXDLL, WXDML, and WXDSL.</p>
<p>Now we have the four inputs of boatable woody debris counts, wadeable woody debris counts, reachlength, and mean bankfull width. By running the function <code>nrsaLargeWoody()</code>, we can calculate the metric <code>v1W_msq</code>, which is the mean bankfull woody debris (m<sup>3</sup>/m<sup>2</sup>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boatCnt &lt;-<span class="st"> </span><span class="kw">subset</span>(woodEx,SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">subset</span>(visitsEx,VALXSITE<span class="op">==</span><span class="st">'BOATABLE'</span>,<span class="dt">select=</span><span class="st">'SITE'</span>)<span class="op">$</span>SITE) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">rename</span>(<span class="kw">c</span>(<span class="st">'PARAMETER'</span>=<span class="st">'CLASS'</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))

wadeCnt &lt;-<span class="st"> </span><span class="kw">subset</span>(woodEx,SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">subset</span>(visitsEx,VALXSITE<span class="op">==</span><span class="st">'WADEABLE'</span>,<span class="dt">select=</span><span class="st">'SITE'</span>)<span class="op">$</span>SITE)  <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">rename</span>(<span class="kw">c</span>(<span class="st">'PARAMETER'</span>=<span class="st">'CLASS'</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))

meanBankfull &lt;-<span class="st"> </span><span class="kw">subset</span>(chanmorphOut,METRIC<span class="op">==</span><span class="st">'xbkf_w'</span>)

  
<span class="co"># Now feed these data frames into the function nrsaLargeWoody()</span>
lwdOut &lt;-<span class="st"> </span><span class="kw">nrsaLargeWoody</span>(<span class="dt">bCounts=</span>boatCnt,<span class="dt">wCounts=</span>wadeCnt,<span class="dt">reachlength=</span><span class="kw">subset</span>(genOut,METRIC<span class="op">==</span><span class="st">'reachlen'</span>),
                         <span class="dt">meanBankfullWidth=</span>meanBankfull)</code></pre></div>
<pre><code>##   Large woody debris metsEnd of ncns
## end of reachlen
## end of lgWoodTranNo
## end of lgwoodsums
## .w.bend of mm
##   Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(lwdOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##   [1] &quot;rchdldll&quot; &quot;rchdldml&quot; &quot;rchdldsl&quot; &quot;rchdmdll&quot; &quot;rchdmdml&quot; &quot;rchdmdsl&quot;
##   [7] &quot;rchdsdll&quot; &quot;rchdsdml&quot; &quot;rchdsdsl&quot; &quot;rchdxdll&quot; &quot;rchdxdml&quot; &quot;rchdxdsl&quot;
##  [13] &quot;rchwldll&quot; &quot;rchwldml&quot; &quot;rchwldsl&quot; &quot;rchwmdll&quot; &quot;rchwmdml&quot; &quot;rchwmdsl&quot;
##  [19] &quot;rchwsdll&quot; &quot;rchwsdml&quot; &quot;rchwsdsl&quot; &quot;rchwxdll&quot; &quot;rchwxdml&quot; &quot;rchwxdsl&quot;
##  [25] &quot;ns&quot;       &quot;nc&quot;       &quot;rchdryt&quot;  &quot;rchwett&quot;  &quot;rchwdt&quot;   &quot;rchtldll&quot;
##  [31] &quot;rchtldml&quot; &quot;rchtldsl&quot; &quot;rchtmdll&quot; &quot;rchtmdml&quot; &quot;rchtmdsl&quot; &quot;rchtsdll&quot;
##  [37] &quot;rchtsdml&quot; &quot;rchtsdsl&quot; &quot;rchtxdll&quot; &quot;rchtxdml&quot; &quot;rchtxdsl&quot; &quot;c1d&quot;     
##  [43] &quot;c1w&quot;      &quot;c1t&quot;      &quot;c1dm100&quot;  &quot;c1tm100&quot;  &quot;c1wm100&quot;  &quot;c1w_msq&quot; 
##  [49] &quot;c2d&quot;      &quot;c2w&quot;      &quot;c2t&quot;      &quot;c2dm100&quot;  &quot;c2tm100&quot;  &quot;c2wm100&quot; 
##  [55] &quot;c2w_msq&quot;  &quot;c3d&quot;      &quot;c3w&quot;      &quot;c3t&quot;      &quot;c3dm100&quot;  &quot;c3tm100&quot; 
##  [61] &quot;c3wm100&quot;  &quot;c3w_msq&quot;  &quot;c4d&quot;      &quot;c4w&quot;      &quot;c4t&quot;      &quot;c4dm100&quot; 
##  [67] &quot;c4tm100&quot;  &quot;c4wm100&quot;  &quot;c4w_msq&quot;  &quot;c5d&quot;      &quot;c5w&quot;      &quot;c5t&quot;     
##  [73] &quot;c5dm100&quot;  &quot;c5tm100&quot;  &quot;c5wm100&quot;  &quot;c5w_msq&quot;  &quot;mddrydia&quot; &quot;mddrylen&quot;
##  [79] &quot;mdwetdia&quot; &quot;mdwetlen&quot; &quot;mdlentot&quot; &quot;mddiatot&quot; &quot;lgdrydia&quot; &quot;lgdrylen&quot;
##  [85] &quot;lgwetdia&quot; &quot;lgwetlen&quot; &quot;lglentot&quot; &quot;lgdiatot&quot; &quot;lwddv33&quot;  &quot;lwdwv33&quot; 
##  [91] &quot;lwddvcal&quot; &quot;lwdwvcal&quot; &quot;lwdtv33&quot;  &quot;lwdtvcal&quot; &quot;shdrylen&quot; &quot;shwetlen&quot;
##  [97] &quot;shlentot&quot; &quot;smdrydia&quot; &quot;smwetdia&quot; &quot;smdiatot&quot; &quot;v1d&quot;      &quot;v1w&quot;     
## [103] &quot;v1t&quot;      &quot;v1dm100&quot;  &quot;v1tm100&quot;  &quot;v1wm100&quot;  &quot;v1w_msq&quot;  &quot;v2d&quot;     
## [109] &quot;v2w&quot;      &quot;v2t&quot;      &quot;v2dm100&quot;  &quot;v2tm100&quot;  &quot;v2wm100&quot;  &quot;v2w_msq&quot; 
## [115] &quot;v3d&quot;      &quot;v3w&quot;      &quot;v3t&quot;      &quot;v3dm100&quot;  &quot;v3tm100&quot;  &quot;v3wm100&quot; 
## [121] &quot;v3w_msq&quot;  &quot;v4d&quot;      &quot;v4w&quot;      &quot;v4t&quot;      &quot;v4dm100&quot;  &quot;v4tm100&quot; 
## [127] &quot;v4wm100&quot;  &quot;v4w_msq&quot;  &quot;v5d&quot;      &quot;v5w&quot;      &quot;v5t&quot;      &quot;v5dm100&quot; 
## [133] &quot;v5tm100&quot;  &quot;v5wm100&quot;  &quot;v5w_msq&quot;  &quot;xldrydia&quot; &quot;xlwetdia&quot; &quot;xldiatot&quot;</code></pre>
</div>
</div>
<div id="substrate-characterization-metrics" class="section level2">
<h2>2.4 Substrate characterization metrics</h2>
<p>The metrics <code>lsub_dmm</code> for all sites and <code>lsub2dmm</code> for wadeable sites only are calculated by the function <code>nrsaSubstrateCharacterization()</code>, which requires substrate inputs from the littoral and thalweg data for boatable sites, and channel/riparian cross-section data from wadeable sites.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(littoralEx)</code></pre></div>
<pre><code>##        SITE TRANSECT     SAMPLE_TYPE PARAMETER VALUE FLAG
## 22004 13799        A PHAB_CHANBFRONT BOTTOMDOM    FN   F1
## 22005 13799        A PHAB_CHANBFRONT BOTTOMSEC    WD   F1
## 22006 13799        A PHAB_CHANBFRONT  SHOREDOM    FN   F1
## 22007 13799        A PHAB_CHANBFRONT  SHORESEC    OT   F1
## 22008 13799        A PHAB_CHANBFRONT    SUBOBS  OBSV   F1
## 22009 13799        B PHAB_CHANBFRONT BOTTOMDOM    FN   F1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(thalwegEx)</code></pre></div>
<pre><code>##        SITE TRANSECT STATION SAMPLE_TYPE PARAMETER VALUE FLAG UNITS
## 48716 10000        A       0  PHAB_THALW BACKWATER     N       NONE
## 48717 10000        A       0  PHAB_THALW  BAR_PRES     N       NONE
## 48718 10000        A       0  PHAB_THALW  CHANUNCD    GL       NONE
## 48719 10000        A       0  PHAB_THALW     DEPTH    18         CM
## 48720 10000        A       0  PHAB_THALW  INCREMNT   1.1          M
## 48721 10000        A       0  PHAB_THALW  POOLFMCD     N       NONE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(channelxsectEx)</code></pre></div>
<pre><code>##        SITE TRANSECT BANK PARAMETER VALUE FLAG SAMPLE_TYPE
## 13643 10000        A   CT     DEPTH    14       PHAB_CHANW
## 13644 10000        A   CT   DIST_LB   1.2       PHAB_CHANW
## 13645 10000        A   CT     EMBED    30       PHAB_CHANW
## 13646 10000        A   CT  SIZE_CLS    GC       PHAB_CHANW
## 13647 10000        A   CT XSIZE_CLS    FN       PHAB_THALW
## 13648 10000        A   LC     DEPTH    10       PHAB_CHANW</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">subcharOut &lt;-<span class="st"> </span><span class="kw">nrsaSubstrateCharacterization</span> (<span class="dt">bBottomDom =</span> <span class="kw">subset</span>(littoralEx, PARAMETER <span class="op">==</span><span class="st"> 'BOTTOMDOM'</span>)
                                    ,<span class="dt">bBottomSec =</span> <span class="kw">subset</span>(littoralEx, PARAMETER <span class="op">==</span><span class="st"> 'BOTTOMSEC'</span>)
                                    ,<span class="dt">bShoreDom =</span> <span class="kw">subset</span>(littoralEx, PARAMETER <span class="op">==</span><span class="st"> 'SHOREDOM'</span>)
                                    ,<span class="dt">bShoreSec =</span> <span class="kw">subset</span>(littoralEx, PARAMETER <span class="op">==</span><span class="st"> 'SHORESEC'</span>)
                                    ,<span class="dt">bSizeClass =</span> <span class="kw">subset</span>(thalwegEx, PARAMETER <span class="op">==</span><span class="st"> 'SIZE_CLS'</span> <span class="op">&amp;</span><span class="st"> </span>
<span class="st">                                                           </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THAL'</span>)
                                    ,<span class="dt">wSizeClass =</span> <span class="kw">subset</span>(channelxsectEx, PARAMETER <span class="op">==</span><span class="st"> 'SIZE_CLS'</span>)
                                    ,<span class="dt">wMezzoSizeClass =</span> <span class="kw">subset</span>(channelxsectEx, PARAMETER <span class="op">==</span><span class="st"> 'XSIZE_CLS'</span>))</code></pre></div>
<pre><code>##   Substrate Characterization.1.  Wadeable substrate begun.2.3.4.5.6.6.7abcde.8.9.  Wadeable substrate done.  Boatable thalweg substrate begun.11.13.  Boatable thalweg substrate done.  Boatable littoral substrate begun.15.  Boatable littoral substrate done Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(subcharOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##   [1] &quot;lsub2d16&quot;     &quot;lsub2d25&quot;     &quot;lsub2d50&quot;     &quot;lsub2d75&quot;    
##   [5] &quot;lsub2d84&quot;     &quot;lsub2dmm&quot;     &quot;lsubd2sd&quot;     &quot;lsub2iqr&quot;    
##   [9] &quot;lsub2dmm_nor&quot; &quot;dgm&quot;          &quot;lsubd2sd_nor&quot; &quot;sub2dmm_nor&quot; 
##  [13] &quot;subd2sd_nor&quot;  &quot;lsub_d16&quot;     &quot;lsub_d25&quot;     &quot;lsub_d50&quot;    
##  [17] &quot;lsub_d75&quot;     &quot;lsub_d84&quot;     &quot;lsub_dmm&quot;     &quot;lsubd_sd&quot;    
##  [21] &quot;lsub_iqr&quot;     &quot;lsub_dmm_nor&quot; &quot;lsubd_sd_nor&quot; &quot;sub_dmm_nor&quot; 
##  [25] &quot;subd_sd_nor&quot;  &quot;lsub2d16inor&quot; &quot;d16&quot;          &quot;lsub2d50inor&quot;
##  [29] &quot;d50&quot;          &quot;lsub2d84inor&quot; &quot;d84&quot;          &quot;pct_bl&quot;      
##  [33] &quot;pct_cb&quot;       &quot;pct_fn&quot;       &quot;pct_gc&quot;       &quot;pct_gf&quot;      
##  [37] &quot;pct_hp&quot;       &quot;pct_ot&quot;       &quot;pct_om&quot;       &quot;pct_rc&quot;      
##  [41] &quot;pct_rr&quot;       &quot;pct_rs&quot;       &quot;pct_sa&quot;       &quot;pct_sb&quot;      
##  [45] &quot;pct_wd&quot;       &quot;pct_xb&quot;       &quot;pct_bigr&quot;     &quot;pct_bdrk&quot;    
##  [49] &quot;pct_safn&quot;     &quot;pct_sfgf&quot;     &quot;pct_org&quot;      &quot;n_nor&quot;       
##  [53] &quot;n&quot;            &quot;pct_bh&quot;       &quot;pct_gr&quot;       &quot;pct_dbbl&quot;    
##  [57] &quot;pct_sbbl&quot;     &quot;pct_dsbl&quot;     &quot;pct_ssbl&quot;     &quot;pct_dbcb&quot;    
##  [61] &quot;pct_sbcb&quot;     &quot;pct_dscb&quot;     &quot;pct_sscb&quot;     &quot;pct_dbfn&quot;    
##  [65] &quot;pct_sbfn&quot;     &quot;pct_dsfn&quot;     &quot;pct_ssfn&quot;     &quot;pct_dbgc&quot;    
##  [69] &quot;pct_sbgc&quot;     &quot;pct_dsgc&quot;     &quot;pct_ssgc&quot;     &quot;pct_dbgf&quot;    
##  [73] &quot;pct_sbgf&quot;     &quot;pct_dsgf&quot;     &quot;pct_ssgf&quot;     &quot;pct_dbhp&quot;    
##  [77] &quot;pct_sbhp&quot;     &quot;pct_dshp&quot;     &quot;pct_sshp&quot;     &quot;pct_dbom&quot;    
##  [81] &quot;pct_sbom&quot;     &quot;pct_dsom&quot;     &quot;pct_ssom&quot;     &quot;pct_dbot&quot;    
##  [85] &quot;pct_sbot&quot;     &quot;pct_dsot&quot;     &quot;pct_ssot&quot;     &quot;pct_dbrc&quot;    
##  [89] &quot;pct_sbrc&quot;     &quot;pct_dsrc&quot;     &quot;pct_ssrc&quot;     &quot;pct_dbrr&quot;    
##  [93] &quot;pct_sbrr&quot;     &quot;pct_dsrr&quot;     &quot;pct_ssrr&quot;     &quot;pct_dbrs&quot;    
##  [97] &quot;pct_sbrs&quot;     &quot;pct_dsrs&quot;     &quot;pct_ssrs&quot;     &quot;pct_dbsa&quot;    
## [101] &quot;pct_sbsa&quot;     &quot;pct_dssa&quot;     &quot;pct_sssa&quot;     &quot;pct_dbsb&quot;    
## [105] &quot;pct_sbsb&quot;     &quot;pct_dssb&quot;     &quot;pct_sssb&quot;     &quot;pct_dbwd&quot;    
## [109] &quot;pct_sbwd&quot;     &quot;pct_dswd&quot;     &quot;pct_sswd&quot;     &quot;pct_dbxb&quot;    
## [113] &quot;pct_sbxb&quot;     &quot;pct_dsxb&quot;     &quot;pct_ssxb&quot;</code></pre>
</div>
<div id="slope-metrics" class="section level2">
<h2>2.5 Slope metrics</h2>
<p>Mean slope is a required input for <code>nrsaBedStability()</code>. The <code>nrsaSlopeBearing()</code> function calculates mean slope as an output. The inputs differ between boatable and wadeable sites. The bearing, slope and distance field measurements at boatable sites are recorded on the NRSA channel/riparian transect form. For wadeable sites, the measurements for slope, bearing, and proportion of transect are recorded on the NRSA slope and bearing form (wadeable sites only). For each transect, there may be more than supplemental readings for slope, bearing, and proportion or distance. The initial or base readings for transect must be coded as LINE=0, with additional readings numbered LINE=1, 2, etc. For slope measurements, METHOD (which should be ‘CL’ if a clinometer is used, and all other methods are treated the same), and UNITS (PERCENT or CM) are also expected to be provided.</p>
<p>For boatable sites, field measurement is generally no longer measured, and the slope is obtained via GIS and passed to the function in the argument <code>gisSlope</code>. This can also be done for wadeable sites. Sinuosity can also be obtained via GIS and passed through the argument <code>gisSinuosity</code>. Only GIS slopes for boatable sites are used as inputs for this example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(changeomEx)</code></pre></div>
<pre><code>##       SITE TRANSECT SAMPLE_TYPE PARAMETER TRANLINE BANK LINE METHOD
## 3710 10000        A  PHAB_SLOPE   BEARING     NONE NONE &lt;NA&gt;     TR
## 3711 10000        A  PHAB_SLOPE      PROP     NONE NONE &lt;NA&gt;     TR
## 3712 10000        A  PHAB_SLOPE     SLOPE     NONE NONE &lt;NA&gt;     TR
## 3713 10000        B  PHAB_SLOPE   BEARING     NONE NONE &lt;NA&gt;     TR
## 3714 10000        B  PHAB_SLOPE      PROP     NONE NONE &lt;NA&gt;     TR
## 3715 10000        B  PHAB_SLOPE     SLOPE     NONE NONE &lt;NA&gt;     TR
##        UNITS VALUE FLAG
## 3710    NONE   231     
## 3711 PERCENT   100     
## 3712      CM   6.9     
## 3713    NONE   244     
## 3714 PERCENT   100     
## 3715      CM   8.8</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># separate changeomEx boatable and wadeable sites</span>
changeom.b &lt;-<span class="st"> </span><span class="kw">subset</span>(changeomEx, SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_CHANBFRONT'</span>)


<span class="kw">head</span>(thalwegEx)</code></pre></div>
<pre><code>##        SITE TRANSECT STATION SAMPLE_TYPE PARAMETER VALUE FLAG UNITS
## 48716 10000        A       0  PHAB_THALW BACKWATER     N       NONE
## 48717 10000        A       0  PHAB_THALW  BAR_PRES     N       NONE
## 48718 10000        A       0  PHAB_THALW  CHANUNCD    GL       NONE
## 48719 10000        A       0  PHAB_THALW     DEPTH    18         CM
## 48720 10000        A       0  PHAB_THALW  INCREMNT   1.1          M
## 48721 10000        A       0  PHAB_THALW  POOLFMCD     N       NONE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bBear &lt;-<span class="st"> </span><span class="kw">subset</span>(changeom.b, PARAMETER<span class="op">==</span><span class="st">'BEAR'</span>) <span class="op">%&gt;%</span>
<span class="st">   </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">LINE=</span><span class="kw">ifelse</span>(LINE<span class="op">==</span><span class="dv">999</span>, <span class="dv">0</span>, LINE))
bDist &lt;-<span class="st"> </span><span class="kw">subset</span>(changeom.b, PARAMETER<span class="op">==</span><span class="st">'DISTANCE'</span>) <span class="op">%&gt;%</span>
<span class="st">   </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">LINE=</span><span class="kw">ifelse</span>(LINE<span class="op">==</span><span class="dv">999</span>, <span class="dv">0</span>, LINE))

gis.bSlp &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SITE=</span><span class="kw">c</span>(<span class="dv">13799</span>,<span class="dv">13904</span>),<span class="dt">VALUE=</span><span class="kw">c</span>(<span class="fl">0.002178</span>,<span class="fl">0.051732</span>))

wBear &lt;-<span class="st"> </span><span class="kw">subset</span>(changeomEx, <span class="kw">grepl</span>(<span class="st">'BEARING'</span>, PARAMETER) <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_SLOPE'</span>) <span class="op">%&gt;%</span>
<span class="st">   </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">LINE =</span> <span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'BEARING'</span>, <span class="dv">0</span>
                ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'BEARING2'</span>, <span class="dv">1</span>
                ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'BEARING3'</span>, <span class="dv">2</span>, <span class="ot">NA</span>
                 ))) ,<span class="dt">PARAMETER =</span> <span class="ot">NULL</span>) 

wTr.alt &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx, PARAMETER<span class="op">==</span><span class="st">'INCREMNT'</span> <span class="op">&amp;</span><span class="st"> </span>TRANSECT<span class="op">==</span><span class="st">'A'</span> <span class="op">&amp;</span><span class="st"> </span>STATION<span class="op">==</span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>
                 ,<span class="dt">select=</span><span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'VALUE'</span>)) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">merge</span>(plyr<span class="op">::</span><span class="kw">ddply</span>(<span class="kw">unique</span>(<span class="kw">subset</span>(thalwegEx,SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>,<span class="dt">select=</span><span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>,<span class="st">'STATION'</span>))),
                    <span class="kw">c</span>(<span class="st">'SITE'</span>,<span class="st">'TRANSECT'</span>),summarise,<span class="dt">nSta =</span> <span class="kw">length</span>(STATION)), <span class="dt">by =</span> <span class="st">'SITE'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE =</span> nSta<span class="op">*</span>VALUE) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>nSta)

wProp &lt;-<span class="st"> </span><span class="kw">subset</span>(changeomEx, <span class="kw">grepl</span>(<span class="st">'PROP'</span>, PARAMETER) <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_SLOPE'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">LINE =</span> <span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'PROP'</span>, <span class="dv">0</span>
                       ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'PROP2'</span>, <span class="dv">1</span>
                               ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'PROP3'</span>, <span class="dv">2</span>, <span class="ot">NA</span>))),<span class="dt">PARAMETER =</span> <span class="ot">NULL</span>
               , <span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))

wSlp &lt;-<span class="st"> </span><span class="kw">subset</span>(changeomEx, <span class="kw">grepl</span>(<span class="st">'SLOPE'</span>, PARAMETER) <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_SLOPE'</span>) <span class="op">%&gt;%</span>
<span class="st">   </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">LINE =</span> <span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'SLOPE'</span>, <span class="dv">0</span>
                ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'SLOPE2'</span>, <span class="dv">1</span>
                ,<span class="kw">ifelse</span>(PARAMETER <span class="op">==</span><span class="st"> 'SLOPE3'</span>, <span class="dv">2</span>, <span class="ot">NA</span>)))
          ,<span class="dt">PARAMETER =</span> <span class="ot">NULL</span>)                 

slopeOut &lt;-<span class="st"> </span><span class="kw">nrsaSlopeBearing</span>(<span class="dt">bBearing =</span> bBear
                              ,<span class="dt">bDistance =</span> bDist
                              ,<span class="dt">wBearing =</span> wBear                            
                              ,<span class="dt">wTransectSpacing =</span> wTr.alt                               
                              ,<span class="dt">wProportion =</span> wProp
                              ,<span class="dt">wSlope =</span> wSlp                        
                              ,<span class="dt">gisSinuosity =</span> <span class="ot">NULL</span>
                              ,<span class="dt">gisSlope =</span> gis.bSlp)</code></pre></div>
<pre><code>##   Slope and bearing calculations.0.1.2.3.4.5.6.7.8.9.10.11.12.13.14.15.16.  Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(slopeOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>## [1] &quot;xslope&quot;        &quot;xslope_map&quot;    &quot;xslope_field&quot;  &quot;pctClinometer&quot;
## [5] &quot;vslope&quot;        &quot;nslp&quot;          &quot;transpc&quot;       &quot;xbearing&quot;     
## [9] &quot;sinu&quot;</code></pre>
</div>
<div id="residual-pools-metrics" class="section level2">
<h2>2.6 Residual pools metrics</h2>
<p>The mean slope from section 2.5 above is required to calculate <code>rp100</code>, the mean residual depth at thalweg in cm, using the function <code>nrsaResidualPools()</code>. The inputs for this function include thalweg depth measurements from the NRSA channel/riparian transect form at boatable sites and from the NRSA thalweg profile and woody debris form at wadeable sites. The transect spacing input for this function is the same format as that used in <code>nrsaGeneral()</code>, so we will just use the data frame created as an input for that function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meanslope &lt;-<span class="st"> </span><span class="kw">subset</span>(slopeOut, METRIC<span class="op">==</span><span class="st">'xslope'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))

bDep &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx,(PARAMETER<span class="op">==</span><span class="st">'DEP_SONR'</span><span class="op">|</span>PARAMETER<span class="op">==</span><span class="st">'DEP_POLE'</span>) <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THAL'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE),<span class="dt">STATION=</span><span class="kw">as.numeric</span>(STATION))
wDep &lt;-<span class="st"> </span><span class="kw">subset</span>(thalwegEx,PARAMETER<span class="op">==</span><span class="st">'DEPTH'</span> <span class="op">&amp;</span><span class="st"> </span>SAMPLE_TYPE<span class="op">==</span><span class="st">'PHAB_THALW'</span>) <span class="op">%&gt;%</span>
<span class="st">  </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE),<span class="dt">STATION=</span><span class="kw">as.numeric</span>(STATION))

respoolOut &lt;-<span class="st"> </span><span class="kw">nrsaResidualPools</span>(<span class="dt">bDepth =</span> bDep     
                           ,<span class="dt">wDepth =</span> wDep     
                           ,<span class="dt">siteSlopes =</span> meanslope
                           ,<span class="dt">transectSpacing =</span> tranSpace)</code></pre></div>
<pre><code>##   Residual Pools calculations.A.B.C.D dataOrganization.w1.w2.w3.w4.w5.b1.b2.b3.b4.b5.b6.b7.1.2.3.4 dimensions.1.2.3.4.5 poolCharacteristics.1.2.3.4   siteSummaries .1.2.3.4.5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(respoolOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##  [1] &quot;rpxlen&quot;     &quot;rpvlen&quot;     &quot;rpmxlen&quot;    &quot;totplen&quot;    &quot;rpxdep&quot;    
##  [6] &quot;rpvdep&quot;     &quot;rpmxdep&quot;    &quot;rpgt50&quot;     &quot;rpgt75&quot;     &quot;rpgt100&quot;   
## [11] &quot;rpgt05&quot;     &quot;rpgt05x&quot;    &quot;rpgt10&quot;     &quot;rpgt10x&quot;    &quot;rpgt20&quot;    
## [16] &quot;rpgt20x&quot;    &quot;rpxdep_cm&quot;  &quot;rpvdep_cm&quot;  &quot;rpmxdep_cm&quot; &quot;rpgt05x_cm&quot;
## [21] &quot;rpgt10x_cm&quot; &quot;rpgt20x_cm&quot; &quot;rpxarea&quot;    &quot;rpvarea&quot;    &quot;rpmxar&quot;    
## [26] &quot;areasum&quot;    &quot;rp100&quot;</code></pre>
</div>
</div>
<div id="calculate-bed-stability-metrics" class="section level1">
<h1>3 Calculate Bed Stability Metrics</h1>
<p>Use all of the metric outputs of other functions to run the bed stability metrics function, <code>nrsaBedStability()</code>. This is done by subsetting each of the output data frames and selecting only the METRIC value of interest. Because the depth-related inputs are specific to boatable or wadeable sites, the output data frame from <code>nrsaChannelMorphology()</code>, <code>chanmorphOut</code> must be split into separate boatable and wadeable pieces. The easiest way to do this is to keep only SITE values that occur in the <code>nrsaChannelMorphology()</code> input <code>bD</code> for boatable inputs and those in <code>wD</code> for wadeable inputs.</p>
<p>Numerous metrics are calculated, but one of the more important metrics calculated by the <code>nrsaBedStabilty()</code> function is <code>lrbs_g08</code>, the log of relative bed stability. This metric is used as an indicator of physical habitat condition.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SITE=</span><span class="kw">unique</span>(bD<span class="op">$</span>SITE),<span class="dt">stringsAsFactors=</span>F)
wade &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SITE=</span><span class="kw">unique</span>(wD<span class="op">$</span>SITE),<span class="dt">stringsAsFactors=</span>F)

bedstabOut &lt;-<span class="st"> </span><span class="kw">nrsaBedStability</span>(<span class="dt">bXdepth =</span>  <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'xdepth'</span> <span class="op">&amp;</span><span class="st"> </span>SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(bD<span class="op">$</span>SITE)
                                                 ,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">bSddepth =</span> <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'sddepth'</span> <span class="op">&amp;</span><span class="st"> </span>SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(bD<span class="op">$</span>SITE)
                                           ,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">wXdepth =</span>  <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'xdepth'</span> <span class="op">&amp;</span><span class="st"> </span>SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(wD<span class="op">$</span>SITE)
                                           ,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">wSddepth =</span> <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'sddepth'</span> <span class="op">&amp;</span><span class="st"> </span>SITE <span class="op">%in%</span><span class="st"> </span><span class="kw">unique</span>(wD<span class="op">$</span>SITE)
                                           ,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">lsub_dmm =</span> <span class="kw">subset</span>(subcharOut, METRIC <span class="op">==</span><span class="st"> 'lsub_dmm'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">lsub2dmm =</span> <span class="kw">subset</span>(subcharOut, METRIC <span class="op">==</span><span class="st"> 'lsub2dmm'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">rp100 =</span>    <span class="kw">subset</span>(respoolOut, METRIC <span class="op">==</span><span class="st"> 'rp100'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">v1w_msq =</span>  <span class="kw">subset</span>(lwdOut, METRIC <span class="op">==</span><span class="st"> 'v1w_msq'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">xbkf_h =</span>   <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'xbkf_h'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">xbkf_w =</span>   <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'xbkf_w'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">xfc_lwd =</span>  <span class="kw">subset</span>(fishCvrOut, METRIC <span class="op">==</span><span class="st"> 'xfc_lwd'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        ,<span class="dt">xslope =</span>   <span class="kw">subset</span>(slopeOut, METRIC <span class="op">==</span><span class="st"> 'xslope'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC) <span class="op">%&gt;%</span>
<span class="st">                          </span>plyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">VALUE=</span><span class="kw">as.numeric</span>(VALUE))
                        ,<span class="dt">xwidth =</span>   <span class="kw">subset</span>(chanmorphOut, METRIC <span class="op">==</span><span class="st"> 'xwidth'</span>,<span class="dt">select=</span><span class="op">-</span>METRIC)
                        )</code></pre></div>
<pre><code>##   Bed stability calculations.1.2.3.4.5.6  Done.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unique</span>(bedstabOut<span class="op">$</span>METRIC)</code></pre></div>
<pre><code>##  [1] &quot;s_rp100&quot;       &quot;ltest&quot;         &quot;lrbs_tst&quot;      &quot;ldmb_bw5&quot;     
##  [5] &quot;s_ldmb_bw5&quot;    &quot;ldmb_bw4&quot;      &quot;lrbs_bw4&quot;      &quot;lrbs_bw5&quot;     
##  [9] &quot;s_lrbs_bw5&quot;    &quot;lrbs_bw6&quot;      &quot;s_lrbs_bw6&quot;    &quot;shld_px3&quot;     
## [13] &quot;reyp3&quot;         &quot;rrpw3&quot;         &quot;cp3ctrpwd_rat&quot; &quot;cp3_mill&quot;     
## [17] &quot;ct_rpwd&quot;       &quot;rb3&quot;           &quot;Dcbf_g08&quot;      &quot;s_Dcbf_g08&quot;   
## [21] &quot;ldcbf_g08&quot;     &quot;s_ldcbf_g08&quot;   &quot;lrbs_g08&quot;      &quot;s_lrbs_g08&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">subset</span>(bedstabOut, METRIC<span class="op">==</span><span class="st">'lrbs_g08'</span>)</code></pre></div>
<pre><code>##     SITE   METRIC     VALUE
## 89 10000 lrbs_g08 -2.549066
## 90 10002 lrbs_g08 -4.088021
## 91 13799 lrbs_g08  1.933206
## 92 13904 lrbs_g08 -1.250798</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
